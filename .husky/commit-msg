#!/bin/sh

COMMIT_MSG_FILE="$1"
BRANCH=$(git branch --show-current)
ENFORCEMENT="soft"
[ "$BRANCH" = "main" ] && ENFORCEMENT="hard"

if ! scripts/validate-commit-msg.sh "$COMMIT_MSG_FILE" "$BRANCH" "$ENFORCEMENT"; then
  exit 1
fi

# Clean up approval file after successful validation on main
if [ "$BRANCH" = "main" ] && [ -f ".commit-approval" ]; then
  rm -f ".commit-approval"
  echo "âœ“ Cleaned up approval file"
fi
